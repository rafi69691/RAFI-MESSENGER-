name: Run Facebook Bot

# à¦•à¦–à¦¨ à¦šà¦¾à¦²à¦¾à¦¬à§‡
on:
  push:
    branches: [ main ]
  schedule:
    - cron: '*/30 * * * *'  # à¦ªà§à¦°à¦¤à¦¿ 30 à¦®à¦¿à¦¨à¦¿à¦Ÿà§‡
  workflow_dispatch:  # à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦²à¦¿ à¦šà¦¾à¦²à¦¾à¦¨à§‹

jobs:
  run-bot:
    runs-on: ubuntu-latest
    
    steps:
    # 1. Code à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡
    - name: Checkout code
      uses: actions/checkout@v3
      
    # 2. Node.js à¦¸à§‡à¦Ÿà¦†à¦ª
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    # 3. Dependencies à¦‡à¦¨à¦¸à§à¦Ÿà¦²
    - name: Install dependencies
      run: |
        npm install
        npm install fca-unofficial fs-extra
        
    # 4. Secrets à¦¥à§‡à¦•à§‡ Credentials à¦²à§‹à¦¡
    - name: Setup credentials
      run: |
        echo "FB_EMAIL=${{ secrets.FB_EMAIL }}" >> .env
        echo "FB_PASSWORD=${{ secrets.FB_PASSWORD }}" >> .env
        echo "OWNER_UID=${{ secrets.OWNER_UID }}" >> .env
        
    # 5. Bot à¦šà¦¾à¦²à¦¾à¦“
    - name: Run Bot
      run: |
        echo "ðŸ¤– Starting Facebook Bot..."
        timeout 300 node bot.js || true
        echo "Bot stopped, will restart..."
        
    # 6. Status à¦šà§‡à¦•
    - name: Check bot status
      run: |
        echo "âœ… Bot process completed"
        echo "ðŸ”„ Will restart in next schedule"
